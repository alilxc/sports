<!DOCTYPE html>
<html lang="en">

	<head>
		<meta charset="utf-8" />
		<title>运动赛事管理信息系统</title>
		<meta name="keywords" content="" />
		<meta name="description" content="" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<link href="assets/css/bootstrap.min.css" rel="stylesheet" />
		<link rel="stylesheet" href="assets/css/font-awesome.min.css" />
		<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Open+Sans:400,300" />
		<link rel="stylesheet" href="assets/css/ace.min.css" />
		<link rel="stylesheet" href="assets/css/ace-rtl.min.css" />
		<link rel="stylesheet" href="assets/css/ace-skins.min.css" />
		<script src="assets/js/ace-extra.min.js"></script>
        <script src="assets/js/myjs/my.js"></script>


    </head>

	<body>
		<!--头部 Begin-->
		<div class="navbar navbar-default" id="navbar">
			<script type="text/javascript">
				try {
					ace.settings.check('navbar', 'fixed')
				} catch(e) {}
			</script>

			<div class="navbar-container" id="navbar-container">
				<div class="navbar-header pull-left">
					<a href="#" class="navbar-brand">
						<small>
							<i class="icon-leaf"></i>
							运动赛事管理信息系统
						</small>
					</a>
				</div>

				<div class="navbar-header pull-right" role="navigation">
					<ul class="nav ace-nav">
						<li class="light-blue">
							<a data-toggle="dropdown" href="#" class="dropdown-toggle">
								<img class="nav-user-photo" src="assets/avatars/user.jpg" alt="Jason's Photo"/>
								<span class="user-info">
									<small>欢迎光临</small>
									<strong id="username"></strong>

								</span>

								<i class="icon-caret-down"></i>
							</a>

							<ul class="user-menu pull-right dropdown-menu dropdown-yellow dropdown-caret dropdown-close">
								<li>
									<div class="col-sm-offset-2 col-sm-10">
										<i class="icon-off"></i>
										<button type="button" onclick="logout()" class="btn btn-default">退出</button>
									</div>
								</li>
							</ul>
						</li>
					</ul>
					<!-- /.ace-nav -->
				</div>
				<!-- /.navbar-header -->
			</div>
			<!-- /.container -->
		</div>
		<!--头部 End-->

		<!--主体部分 Begin-->
		<div class="main-container" id="main-container">
			<script type="text/javascript">
				try {
					ace.settings.check('main-container', 'fixed')
				} catch(e) {}
			</script>

			<div class="main-container-inner">
				<a class="menu-toggler" id="menu-toggler" href="#">
					<span class="menu-text"></span>
				</a>

				<!--左侧导航 Begin-->
				<div class="sidebar" id="sidebar">
					<script type="text/javascript">
						try {
							ace.settings.check('sidebar', 'fixed')
						} catch(e) {}
					</script>

					<ul class="nav nav-list" id="navlist">
						<li class="active navshowa">
							<a href="index.html">
								<i class="icon-dashboard"></i>
								<span class="menu-text">首页</span>
							</a>
						</li>

						<li class="active navshowa1">
							<a href="project.html">
								<i class="icon-text-width"></i>
								<span class="menu-text">赛事管理</span>

								<b class="arrow icon-angle-down"></b>
							</a>

							<ul class="submenu">
								<li class="navshowa21">
									<a href="sub_project.html">
										<i class="icon-double-angle-right"></i> 项目管理
									</a>
								</li>
							</ul>
						</li>

						<li class="active navshowa2">
							<a href="#" class="dropdown-toggle">
								<i class="icon-desktop"></i>
								<span class="menu-text">成绩查询</span>

								<b class="arrow icon-angle-down"></b>
							</a>

							<ul class="submenu">
								<li class="navshowa21">
									<a href="search_person.html">
										<i class="icon-double-angle-right"></i> 状态查询
									</a>
								</li>

								<!--<li class="navshowa22">
									<a href="search_school.html">
										<i class="icon-double-angle-right"></i> 团队查询
									</a>
								</li>-->
							</ul>
						</li>

						<li class="active navshowa3">
							<a href="#" class="dropdown-toggle">
								<i class="icon-list"></i>
								<span class="menu-text">报名管理</span>

								<b class="arrow icon-angle-down"></b>
							</a>

							<ul class="submenu">
								<li class="navshowa31">
									<a href="enter.html">
										<i class="icon-double-angle-right"></i> 报名
									</a>
								</li>

								<li class="navshowa32">
									<a href="enter_msg.html">
										<i class="icon-double-angle-right"></i> 报名信息查询
									</a>
								</li>
							</ul>
						</li>

						<li class="active navshowa4">
							<a href="addscore.html" class="dropdown-toggle">
								<i class="icon-edit"></i>
								<span class="menu-text">成绩录入</span>
							</a>
						</li>

						<li class="active navshowa5">
							<a href="usermsg.html" class="dropdown-toggle">
								<i class="icon-apple"></i>
								<span class="menu-text">权限管理</span>
							</a>
						</li>
					</ul>
					<!-- /.nav-list -->
				</div>
				<!--左侧导航 End-->

				<!--右侧内容 Begin-->
				<div class="main-content">
					<!--面包屑导航 Begin-->
					<div class="breadcrumbs" id="breadcrumbs">
						<script type="text/javascript">
							try {
								ace.settings.check('breadcrumbs', 'fixed')
							} catch(e) {}
						</script>

						<ul class="breadcrumb">
							<li>
								<i class="icon-home home-icon"></i>
								<a href="index.html" class="active">首页</a>
							</li>
						</ul>
					</div>
					<!--面包屑导航 End-->

					<!--内容 Begin-->
					<div class="page-content">
						<!--项目选择 Begin-->
						<!--<div class="row">
							<div class="col-xs-12" style="padding-top: 30px;">
								&lt;!&ndash; PAGE CONTENT BEGINS &ndash;&gt;

								&lt;!&ndash;输入框 Begin&ndash;&gt;
								<div class="form-group">
									<form class="form-horizontal" role="form">

										<label class="col-sm-3 control-label no-padding-right">项目名称:</label>

										<div class="col-sm-5">
											<select id="projectid"  class="col-xs-10 col-sm-5" >
											</select>
										</div>
									</form>
									<div class="col-sm-4">
										<button class="btn btn-white" onclick="showSchoolScoreInfo()">
											查询
										</button>
									</div>

								</div>



								<div class="row">
                                    <div class="col-xs-12">
                                        <div class="table-responsive">
                                            <table id="table4" class="table table-striped table-bordered table-hover">
                                                <thead>
                                                    <tr>
                                                        <th>团队</th>
                                                        <th>编号</th>
                                                        <th class="hidden-480">姓名</th>
                                                        <th>项目名称</th>
                                                        <th>项目类别</th>
                                                        <th>组别</th>
                                                        <th>个人成绩</th>
                                                    </tr>
                                                </thead>

                                                <tbody>

                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
							</div>
						</div>-->
						<!--项目选择 End-->
						<div class="row">
							<div class="col-sm-10">
								<div class="tabbable">
									
									<!--选项卡 Begin-->
									<!--<ul class="nav nav-tabs" id="myTab">
										
										<li class="active">
											<a data-toggle="tab" href="#home" onclick="showProjectInfo(1)">
												小组赛
											</a>
										</li>
										
										<li>
											<a data-toggle="tab" href="#profile" onclick="showProjectInfo(2)">
												初赛
											</a>
										</li>
						
										<li>
											<a data-toggle="tab" href="#endpro" onclick="showProjectInfo(3)">
												决赛
											</a>
										</li>
									</ul>-->
									<!--选项卡 End-->
									
									<!--选项内容 Begin-->
									<div class="tab-content">
										
										<!--小组赛 Begin-->
										<div id="home" class="tab-pane in active">
											<div class="row">
													<div class="col-xs-12">

														<!--<button class="btn btn-info dialogalert"  type="button" style="float: right;" data-toggle="modal" data-target="#myMember">
															名单导入
															<i class="icon-print  align-top bigger-125 icon-on-right"></i>
														</button>-->

														<button class="btn btn-info dialogalert"  type="button" style="float: right;" data-toggle="modal" data-target="#myModal">
															录入成绩
															<i class="icon-print  align-top bigger-125 icon-on-right"></i>
														</button>

														<div class="table-responsive">
															<table id="table1" class="table table-striped table-bordered table-hover">
																<thead>
																	<tr>
                                                                        <th>团队</th>
                                                                        <th>编号</th>
                                                                        <th class="hidden-480">姓名</th>
                                                                        <th>项目名称</th>
                                                                        <th>项目类别</th>
                                                                        <th>组别</th>
                                                                        <th>成绩</th>
																	</tr>
																</thead>
																
																<tbody>

																</tbody>
															</table>
														</div>
													</div>
												</div>
										</div>

										
									</div>
									<!--选项内容 End-->
								</div>
							</div>
							<!-- /span -->
						</div>
					</div>
					<!--内容 End-->
				</div>
				<!--右侧内容 End-->
		</div>

			<!--<div class="modal fade" id="myMember" tabindex="-1" role="dialog" aria-labelledby="myMemberLabel" aria-hidden="true">
				<div class="modal-dialog">
					<div class="modal-content">
						<div class="modal-header">
							<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
							<h4 class="modal-title" id="myMemberLabel">分组名单导入</h4>
						</div>

						<div class="space-2"></div>

						&lt;!&ndash; 名单录入弹框BEGINS &ndash;&gt;

						<form class="form-horizontal" role="form" id="importMembers" enctype="multipart/form-data">
							<div class="space-4"></div>

							<div class="form-group">
								<label class="col-sm-3 control-label no-padding-right" for="form-field-0">赛事</label>

								<div class="col-sm-6">
									<select id="gameType" placeholder="" class="col-xs-10 col-sm-5" name="gameType">
									</select>
								</div>
							</div>

							<div class="space-4"></div>

							<div class="form-group">
								<label class="col-sm-3 control-label no-padding-right" for="form-field-1">名单</label>

								<div class="col-sm-6">
									<input type="file" name="members" placeholder="" id="memberFile" class="col-xs-10 col-sm-8" />
								</div>
							</div>

							<div class="space-4"></div>

							<div class="modal-footer">
								<button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
								<button type="button" class="btn btn-primary" onclick="importMember()">上传</button>
							</div>
						</form>


					</div>&lt;!&ndash; /.modal-content &ndash;&gt;
				</div>&lt;!&ndash; /.modal &ndash;&gt;
			</div>
-->
			<!--弹框（Modal） -->
			<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
				<div class="modal-dialog" style="width:800px;">
					<div class="modal-content">
						<div class="modal-header">
							<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
							<h4 class="modal-title" id="myModalLabel">成绩录入</h4>
						</div>

						<!-- 成绩录入弹框BEGINS -->
						<div class="modal-body">

						<form class="form-horizontal" role="form" id="addscores">

							<div class="form-group">

								<div class="input-group-btn">

									<label class="col-sm-5 control-label no-padding-right" for="form-field-2">赛事</label>

									<div class="col-sm-6">
										<select id="gameType" placeholder="" class="col-xs-10 col-sm-5 form-control"
												name="gameType" onchange="gameChange($('#gameType option:selected').val())">
										</select>
									</div>
								</div>

								<div class="input-group-btn">
									<label class="col-sm-2 control-label no-padding-right" for="form-field-1">场地</label>

									<div class="col-sm-6">
										<select id="place" placeholder="" class="col-xs-10 col-sm-5 form-control"
												name="place" onchange="placeChange($('#place option:selected').val())">
										</select>
									</div>
								</div>

								<div class="space-8"></div>

								<div class="table-responsive" style="height:300px;overflow:auto; ">
									<table id="table2" class="table table-striped table-bordered table-hover" width="100%">
										<thead>
										<tr>
											<th>编号</th>
											<th class="hidden-480">姓名</th>
											<th>团队</th>
											<th>组别</th>
											<th>项目代码</th>
											<th>项目名称</th>
											<th>成绩</th>
										</tr>
										</thead>

										<tbody>

										</tbody>
									</table>
								</div>
							</div>

							<div class="space-4"></div>
							<div class="modal-footer">
								<button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
								<button type="button" class="btn btn-primary" onclick="addScore()">提交</button>
							</div>
						</form>

						</div>
					</div>
				</div>
			</div>

		</div>


		<script src="assets/js/jquery-2.0.3.min.js"></script>
		<script type="text/javascript">
            window.jQuery || document.write("<script src='assets/js/jquery-2.0.3.min.js'>" + "<" + "script>");
		</script>
		<script type="text/javascript">
            if("ontouchend" in document) document.write("<script src='assets/js/jquery.mobile.custom.min.js'>" + "<" + "script>");
		</script>

		<script src="assets/js/bootstrap.min.js"></script>
		<script src="assets/js/typeahead-bs2.min.js"></script>
		<script src="assets/js/jquery-ui-1.10.3.custom.min.js"></script>
		<script src="assets/js/jquery.ui.touch-punch.min.js"></script>
		<script src="assets/js/jquery.slimscroll.min.js"></script>
		<script src="assets/js/jquery.easy-pie-chart.min.js"></script>
		<script src="assets/js/jquery.sparkline.min.js"></script>
		<script src="assets/js/flot/jquery.flot.min.js"></script>
		<script src="assets/js/flot/jquery.flot.pie.min.js"></script>
		<script src="assets/js/flot/jquery.flot.resize.min.js"></script>
		<script src="assets/js/ace-elements.min.js"></script>
		<script src="assets/js/ace.min.js"></script>
		<script src="assets/js/myjs/index.js"></script>

		<script type="text/javascript">
            var dataArr = null;
            var isTeam = false;
            function placeChange(place){
                var gameType = document.getElementById("gameType").value;
                $.ajax({
                    type: "GET",//方法类型
                    contentType: "application/json",
                    dataType: "json",//预期服务器返回的数据类型
                    data: {gameName: gameType, place: place},
                    url: "/scoreAddController/queryGroupMember",
                    async: false,
                    success: function (result) {
                        if (result.httpStatus == 200) {
                            var content = "";
                            var object = result.data;
							dataArr = object.groupingMemberDTOList;
							isTeam = object.team;
                            $.each(dataArr, function(index, item){
                                userList = item.achievementInfoList;
                                num = userList.length;
                                groupName = item.groupName;
                                projectId = item.projectId;
                                projectName = item.projectName;
                                teamType = item.teamType;
                                for(var i = 0; i < num; i++){
                                    user = userList[i];
                                    content += "<tr>" +
                                        "<td class='center'><a>"+user.id+"</a></td>" +
                                        "<td>" + user.username+"</td>";
									if(i == 0){
										content += "<td style='text-align:center;vertical-align: middle' rowspan='" + num + "'>" + item.groupName+ "</td>";
									}
                                    if(i == 0){
                                        content += "<td style='text-align:center;vertical-align: middle' rowspan='" + num + "'>" + item.teamType+ "</td>";
                                    }
                                    if(i == 0){
                                        content += "<td style='text-align:center;vertical-align: middle' rowspan='" + num + "'>" + item.projectId+ "</td>";
                                    }
                                    if(i == 0){
                                        content += "<td style='text-align:center;vertical-align: middle' rowspan='" + num + "'>" + item.projectName+ "</td>";
                                    }
                                    if(i == 0){
                                        content += "<td style='text-align:center;vertical-align: middle' class='hidden-480' rowspan='" + num + "'>" +
											"<input type='text' name='score' class='col-xs-10 col-sm-5' /></td>";
                                    }
                                    content += "</tr>";
								}
                            });
                            $("#table2 tbody").empty();
                            $("#table2 tbody").html(content);
                        };
                    },
                    error: function () {
                        alert("异常！");
                    }
                })
            }
		</script>


		<script type="text/javascript">
			var competitionId = null;
            function gameChange(gameName){
                $.ajax({
                    type: "GET",//方法类型
                    contentType: "application/json",
                    dataType: "json",//预期服务器返回的数据类型
                    data: {gameName: gameName},
                    url: "/projectController/queryGamePlaces",
                    async: false,
                    success: function (result) {
                        if (result.httpStatus == 200) {
                            var content = "";
                            var object = result.data;
                            competitionId = object.competitionId;
                            dataArr = object.places;
                            var nameOpt = "<option value='' selected='selected'>--请选择--</option>";
                            for (var i = 0; i < dataArr.length; i++) {
                                nameOpt+="<option value='"+dataArr[i]+"' >"+dataArr[i]+"</option>"
                            }
                            $('#place').html(nameOpt);
                        };
                    },
                    error: function () {
                        alert("异常！");
                    }
                })
            }
		</script>


		<script type="text/javascript">
            window.onload = showGames();
            function showGames(){
                $.ajax({
                    type: "GET",//方法类型
                    contentType: "application/json",
                    dataType: "json",//预期服务器返回的数据类型
                    url: "/projectController/queryGameList",
                    async: false,
                    success: function (result) {
                        if (result.httpStatus == 200) {
                            var content = "";
                            var dataArr = result.data;
                            var nameOpt = "<option value='' selected='selected'>--请选择--</option>";
                            for (var i = 0; i < dataArr.length; i++) {
                                nameOpt+="<option value='"+dataArr[i]+"' >"+dataArr[i]+"</option>"
                            }
                            $('#gameType').html(nameOpt);
                        };
                    },
                    error: function () {
                        alert("异常！");
                    }
                })
            }
		</script>


		<script type="text/javascript">
            function addScore() {
                /*$('#table2 tr').each(function () {
					$(this).children('td').each(function () {
						console.log()
                    })
                });*/
                var tableObj = document.getElementById("table2");
                var paramArray = new Array();
                var num = tableObj.rows[0].cells.length;
                for (var i = 1; i < tableObj.rows.length; i++) {
                    if(tableObj.rows[i].cells.length == num){
                        id = tableObj.rows[i].cells[0].innerText;
                        username = tableObj.rows[i].cells[1].innerText;
                        groupName = tableObj.rows[i].cells[2].innerText;
                        teamType = tableObj.rows[i].cells[3].innerText;
                        sysProjectId = tableObj.rows[i].cells[4].innerText;
                        projectName = tableObj.rows[i].cells[5].innerText;
                        score = tableObj.rows[i].cells[6].childNodes[0].value;
                        paramArray.push({"groupName": groupName, "sysProjectId":sysProjectId, "teamType":teamType,
						"score":score, "team": isTeam, "id":id})
					}
                }
                var place = $('#place option:selected').val();
                var scoreAddRequest = {};
                scoreAddRequest.scoreAddInfoList = paramArray;
                scoreAddRequest.competitionId = competitionId;
                scoreAddRequest.place = place;
                $.ajax({
                    //几个参数需要注意一下
                    type: "POST",//方法类型
					contentType: "application/json",
                    dataType: "json",//预期服务器返回的数据类型
                    url: "/scoreAddController/addScore",//url
                    data:JSON.stringify(scoreAddRequest),
                    async: false,
                    success: function (result) {
                        if (result) {
                            alert("录入成绩成功！");
                            window.location.href = "/static/addscore.html";
                        };
                    },
                    error: function () {
                        alert("异常！");
                        window.location.href = "/static/addscore.html";
                    }
                });
            }
		</script>
		<script type="text/javascript">
            window.onload = showProjects();
            function showProjects(){
                $.ajax({
                    type: "POST",//方法类型
                    contentType: "application/json",
                    dataType: "json",//预期服务器返回的数据类型
                    url: "/scoreAddController/sysProject",//url
                    async: false,
                    success: function (result) {
                        // console.log(result);//打印服务端返回的数据(调试用)
                        /* <option value="0">田径</option>
                         <option value="0">羽毛球</option>*/
                        if (result.httpStatus == 200) {
                            var content = "";
                            var dataArr = result.data;
                            $.each(dataArr, function(index, item){
                                console.log(item);
                                content += '<option value=' + item.id + '>' + item.name + '</option>';
                            });
                            $("#projectid").empty();
                            $("#projectid").html(content);
                        };
                    },
                    error: function () {
                        alert("异常！");
                    }
                })
            }
		</script>
		<script type="text/javascript">
            function showSchoolScoreInfo(){
                var sid;//传过去projectid
                sid = $("#projectid").val();
                // alert(sid);
                $.ajax({
                    type: "POST",//方法类型
                    // contentType: "application/json",
                    dataType: "json",//预期服务器返回的数据类型
                    data: {id: sid},
                    url: "/scoreAddController/schoolScoreInfo",//url
                    async: false,
                    success: function (result) {
                        if (result.httpStatus == 200) {
                            var content = "";
                            var dataArr = result.data;
                            $.each(dataArr, function(index, item){

                                console.log(item);
                                content += "<tr>" +
                                    "<td class='center'><a>"+item.sysCollegeName+"</a></td>" +
                                    "<td>" + item.sid+"</td>" +
                                    "<td class='hidden-480'>"+item.name+ "</td>" +
                                    "<td>" + item.sysProjectName + "</td>" +
                                    "<td>" + item.sportType + "</td>" +
                                    "<td>" + item.teamType + "</td>" +
                                    "<td class='hidden-480'>"+item.achievement+ "</td>" +
                                    "</tr>";
                            });
                            $("#table4").empty();
                            $("#table4").html(content);
                        };
                    },
                    error: function () {
                        alert("异常！");
                    }
                })
            }
		</script>
		<script type="text/javascript">
            function showProjectInfo(matchType){
                // alert("matchType="+matchType);
                matchType = matchType || 1;
                $.ajax({
                    type: "POST",//方法类型
                    dataType: "json",//预期服务器返回的数据类型
                    data: {matchType: matchType},
                    url: "/scoreAddController/sysProjectInfo",//url
                    async: false,
                    success: function (result) {
                        if (result.httpStatus == 200) {
                            var content = "";
                            var dataArr = result.data.list;
                            $.each(dataArr, function(index, item){
                                console.log(item);
                                content += "<tr>" +
                                    "<td class='center'><a >"+item.sysCollegeName+"</a></td>" +
                                    "<td>" + item.sid+"</td>" +
                                    "<td class='hidden-480'>"+item.name+ "</td>" +
                                    "<td class='hidden-480'>"+item.sysProjectName+ "</td>" +
                                    "<td>" + item.sportType + "</td>" +
                                    "<td>" + item.teamType + "</td>" +
                                    "<td class='hidden-480'>"+item.achievement+ "</td>" +
                                    "</tr>";
                            });
                            $("#table" + matchType).empty();
                            $("#table" + matchType).html(content);
                        };
                    },
                    error: function () {
                        alert("异常！");
                    }
                })
            }

		</script>

	</body>

</html>